---
title: "Lab 02a: MOMA cleaning"
subtitle: "CS631"
author: "Alison Hill"
output:
  html_document:
    theme: flatly
---

<script src="/rmarkdown-libs/header-attrs/header-attrs.js"></script>
<link href="/rmarkdown-libs/anchor-sections/anchor-sections.css" rel="stylesheet" />
<script src="/rmarkdown-libs/anchor-sections/anchor-sections.js"></script>


<div id="load-the-moma-data" class="section level1">
<h1>Load the MOMA data</h1>
<pre class="r"><code>library(here)
library(readr)
library(janitor)</code></pre>
<pre><code>Error in library(janitor): there is no package called &#39;janitor&#39;</code></pre>
<pre class="r"><code>library(dplyr)
moma &lt;- read_csv(here::here(&quot;data&quot;, &quot;artworks.csv&quot;),
                 col_types = cols(
                   BeginDate = col_number(),
                   EndDate = col_number(),
                   `Length (cm)` = col_number(),
                   `Circumference (cm)` = col_number(),
                   `Duration (sec.)` = col_number(),
                   `Diameter (cm)` = col_number()
                 )) %&gt;% 
  clean_names()</code></pre>
<pre><code>Error: &#39;/Volumes/Macintosh HD - Data/2020-10-20-r4b/site/course-r4bee/data/artworks.csv&#39; does not exist.</code></pre>
<pre class="r"><code>problems(moma)</code></pre>
<pre><code>Error in withCallingHandlers(expr, warning = function(w) if (inherits(w, : object &#39;moma&#39; not found</code></pre>
<p>Basic cleaning with <code>stringr</code> of <code>gender</code> variable, which refers to the gender of the artist (a <code>()</code> is used a placeholder for “various artists”)</p>
<pre class="r"><code>library(stringr)
moma &lt;- moma %&gt;% 
  mutate(gender = str_replace_all(gender, fixed(&quot;(female)&quot;, 
                                                    ignore_case = TRUE), &quot;F&quot;),
         gender = str_replace_all(gender, fixed(&quot;(male)&quot;, 
                                                    ignore_case = TRUE), &quot;M&quot;),
         num_artists = str_count(gender, &quot;[:alpha:]&quot;),
         num_artists = na_if(num_artists, 0),
         n_female_artists = str_count(gender, &quot;F&quot;),
         n_male_artists = str_count(gender, &quot;M&quot;),
         artist_gender = case_when(
           num_artists == 1 &amp; n_female_artists == 1 ~ &quot;Female&quot;,
           num_artists == 1 &amp; n_male_artists == 1 ~ &quot;Male&quot;
         ))</code></pre>
<pre><code>Error in eval(lhs, parent, parent): object &#39;moma&#39; not found</code></pre>
<p>Let’s also do some detecting of strings in the <code>credit_line</code> variable.</p>
<pre class="r"><code>moma &lt;- moma %&gt;% 
  mutate(purchase = str_detect(credit_line, fixed(&quot;purchase&quot;, ignore_case = TRUE)),
         gift = str_detect(credit_line, fixed(&quot;gift&quot;, ignore_case = TRUE)),
         exchange = str_detect(credit_line, fixed(&quot;exchange&quot;, ignore_case = TRUE)))</code></pre>
<pre><code>Error in eval(lhs, parent, parent): object &#39;moma&#39; not found</code></pre>
<p>According to <a href="https://www.moma.org/momaorg/shared/pdfs/docs/explore/CollectionsMgmtPolicyMoMA_Oct10.pdf">MOMA</a>:
Acquisitions to the Collection may be made by purchase, gift, fractional interest gift, bequest, or exchange.</p>
<p>Let’s clean up some dates:</p>
<ul>
<li>We’ll clean up year acquired with <code>lubridate</code> to pull out the <code>year</code>.</li>
<li>We’ll rename two date variables that are the artist birth/death year, but aren’t labelled clearly.</li>
<li>We’ll do a very rough estimate of the date each piece was created, using <code>stringr::str_extract()</code></li>
</ul>
<pre class="r"><code>library(lubridate)
moma &lt;- moma %&gt;% 
  mutate(year_acquired = year(date_acquired)) %&gt;% 
  rename(artist_birth_year = begin_date, artist_death_year = end_date) %&gt;% 
  mutate(year_created = str_extract(date, &quot;\\d{4}&quot;),
         artist_birth_year = na_if(artist_birth_year, 0),
         artist_death_year = na_if(artist_death_year, 0))</code></pre>
<pre><code>Error in eval(lhs, parent, parent): object &#39;moma&#39; not found</code></pre>
<p>What different kinds of art classifications are available?</p>
<pre class="r"><code>moma %&gt;% 
  distinct(classification) %&gt;% 
  print(n = Inf)</code></pre>
<pre><code>Error in eval(lhs, parent, parent): object &#39;moma&#39; not found</code></pre>
<p>We want to focus on standard rectangular paintings:</p>
<ul>
<li>Filter based on classification</li>
<li>Drop all pieces of art that have either missing (<code>NA</code>) height or width measurements, or who have <code>0</code> for either height or width.</li>
</ul>
<pre class="r"><code>library(tidyr)
moma &lt;- moma %&gt;% 
  filter(classification == &quot;Painting&quot;) %&gt;% 
  drop_na(height_cm, width_cm) %&gt;% 
  filter(height_cm &gt; 0 &amp; width_cm &gt; 0)</code></pre>
<pre><code>Error in eval(lhs, parent, parent): object &#39;moma&#39; not found</code></pre>
<p>We’ll select those columns we want to keep:</p>
<pre class="r"><code>moma &lt;- moma %&gt;% 
  select(title, contains(&quot;artist&quot;), contains(&quot;year&quot;), contains(&quot;_cm&quot;),
         purchase, gift, exchange, classification, department)</code></pre>
<pre><code>Error in eval(lhs, parent, parent): object &#39;moma&#39; not found</code></pre>
<p>Now let’s export this data frame for the lab.</p>
<pre class="r"><code>write_csv(moma, here::here(&quot;data&quot;, &quot;artworks-cleaned.csv&quot;))</code></pre>
<pre><code>Error in is.data.frame(x): object &#39;moma&#39; not found</code></pre>
</div>
